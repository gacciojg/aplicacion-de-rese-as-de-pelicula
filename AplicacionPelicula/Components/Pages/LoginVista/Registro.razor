@page "/Registro"
@using AplicacionPelicula.Modelos
@using AplicacionPelicula.Servicios
@inject LoginService LoginService
@inject NavigationManager Navigation

<style>
	body, .page{
		background-color:#12121212 !important;
		color: #fff;
		margin: 0;
		padding: 0;
		font-family: Arial, sans-serif;
	}

	.registro-container{
		max-width: 380px;
		margin: 0 auto;
		padding: 40px 20px;
		text-align: center;
	}

	.registro-container h3{
		margin-bottom: 25px;
		font-size: 26px;
		color: #2ecc71 /*verde para diferenciar de login*/
	}

	.form-control{
		width: 100%;
		padding: 12px;
		margin-bottom: 15px;
		border-radius: 8px;
		border: none;
		outline: none;
		font-size: 16px;
	}

	.btn{
		width: 100%;
		padding: 12px;
		border-radius: 8px;
		font-size: 16px;
		margin-top: 10px;
	}

	.btn-success{
		background-color: #2ecc71;
		border: none;
	}

	.btn-success:hover{
		background-color: #27ae60;
	}

	.text-danger{
		margin-top: 10px;
		font-weight: bold;
		color: #e74c3c;
	}
</style>

<div class="registro-container">
	<h3>crear cuenta</h3>

	<div class="mb-3">
		<label>usuario:</label>
		<input type="text" @bind="username" class="form-control" placeholder="ingrese su usuario" />
	</div>

	<div class="mb-3">
		<label>contraseña:</label>
		<input type="password" @bind="password" class="form-control" placeholder="ingrese su contraseña" />
	</div>

	<div class="mb-3">
		<label>rol:</label>
		<select @bind="rol" class="form-control">
			<option value="Usuario">usuario</option>
			<option value="Administrador">administrador</option>
		</select>
	</div>

	<button class="btn btn-success" @onclick="RegistrarUsuario">registrarse</button>
	<p class="text-danger">@mensajeError</p>
</div>

@code {
	private string username = string.Empty;
	private string password = string.Empty;
	private string rol = "Usuario";//valor por defecto
	private string mensajeError = string.Empty;

	private async Task RegistrarUsuario()
	{
		mensajeError = string.Empty;

		var (exito, mensaje) = await LoginService.RegistrarUsuario(username, password, rol);
		if (exito)
		{
			Navigation.NavigateTo("/");
		}
		else
		{
			mensajeError = mensaje;
		}
	}
}

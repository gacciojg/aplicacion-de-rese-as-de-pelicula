@page "/"
@using AplicacionPelicula.Modelos
@inject LoginService LoginService
@inject NavigationManager Navigation

<style>
    body, .page {
        background-color: #121212 !important;
        color: #fff;
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
    }

<style>
    .login-container {
        max-width: 380px;
        margin: 0 auto;
        padding: 40px 20px;
        text-align: center;
    }

        .login-container h3 {
            margin-bottom: 25px;
            font-size: 26px;
            color: #f1c40f;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

    .form-control {
        width: 100%;
        padding: 12px;
            margin-bottom: 15px;
        border-radius: 8px;
        border: none;
        outline: none;
        font-size: 16px;
        }

    .btn {
            width: 100%;
        padding: 12px;
        border-radius: 8px;
        font-size: 16px;
        margin-top: 10px;
    }

    .btn-primary {
        background-color: #3498db;
        border: none;
    }

        .btn-primary:hover {
            background-color: #2980b9;
        }

    .btn-secondary {
        background-color: #2ecc71;
        border: none;
    }

        .btn-secondary:hover {
            background-color: #27ae60;
        }

    .text-danger {
            margin-top: 10px;
            font-weight: bold;
        color: #e74c3c;
        }
</style>

<div class="login-container">
    <h3>
        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
            <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1" />
            <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117M11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5M4 1.934V15h6V1.077z" />
        </svg>
        Iniciar Sesion
    </h3>

    <div class="mb-3">
        <label>Usuario:</label>
        <input type="text" @bind="username" class="form-control" />
    </div>

    <div class="mb-3">
        <label>Contraseña:</label>
        <input type="password" @bind="password" class="form-control" />
    </div>

    <button class="btn btn-primary" @onclick="LoginUsuario">Ingresar</button>
    <button class="btn btn-secondary">Registrarse</button>

    <p class="text-danger">@mensajeError</p>
</div>

@code {
	private string username = string.Empty;
	private string password = string.Empty;
	private string mensajeError = string.Empty;

	private async Task LoginUsuario()
	{
		mensajeError = string.Empty;//limpia mensajes anteriores 

		var usuario = await LoginService.validarUsuario(username, password);

		if (usuario != null)
		{
			if(usuario.Username == "admin")
			{
				Navigation.NavigateTo("/menu");//si esta bien, se reedirige al menu
			} else if(usuario.Username == "user")
			{
				Navigation.NavigateTo("/gestionReseñas");
			}
			else
			{
				mensajeError = "no tienes permiso para acceder";
			}
		}
		else
		{
			mensajeError = "usuario o contraseña incorrectos";
		}
	}
}
